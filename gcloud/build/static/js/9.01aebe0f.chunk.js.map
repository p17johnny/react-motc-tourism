{"version":3,"sources":["services/ptxAuth.js","redux/ptx/actions.js","components/attraction/index.js","components/attraction/style.module.scss","components/details/index.js","pages/allspot/style.module.scss","pages/allspot/index.js"],"names":["getPTXauth","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","process","update","Authorization","getHMAC","loadAll","skip","dispatch","axios","get","headers","then","res","catch","err","console","log","loadCity","city","loadMap","type","payload","data","Attraction","handleClickAttraction","useDispatch","className","style","head","backgroundImage","Picture","PictureUrl1","height","onClick","Class1","level","ellipsis","rows","expandable","Name","symbol","minHeight","Description","DescriptionDetail","module","exports","contentStyle","width","color","lineHeight","textAlign","background","Details","store","useStore","autoplay","dotPosition","getState","ptx","src","alt","PictureUrl2","PictureUrl3","plain","OpenTime","Position","PositionLat","PositionLon","lat","lng","window","open","clickToGMap","Address","TravelInfo","WebsiteUrl","href","target","title","Home","useState","setData","hasMore","setHasMore","setOpen","pageStart","loadMore","length","status","concat","message","error","loader","map","e","visible","maskClosable","footer","onCancel","top"],"mappings":"mOAuBeA,EArBI,WACjB,IAEIC,GAAY,IAAIC,MAAOC,cACvBC,EAAS,IAAIC,IAAM,QAAS,QAWhC,OAVAD,EAAOE,WAHMC,8BAGa,QAC1BH,EAAOI,OAAO,WAAaP,GASpB,CACLQ,cAPA,yGAFSL,EAAOM,QAAQ,OAMxB,IAIA,SAAUT,IChBDU,EAAU,SAACC,GAAD,OAAU,SAACC,GAChC,OAAOC,IACJC,IADI,gFAEsEH,EAFtE,iBAGH,CACEI,QAAShB,MAGZiB,MAAK,SAACC,GACL,OAAOA,KAERC,OAAM,SAACC,GACNC,QAAQC,IAAIF,QAGLG,EAAW,SAACC,EAAMZ,GAAP,OAAgB,SAACC,GACvC,OAAOC,IACJC,IADI,kEAEwDS,EAFxD,0BAE8EZ,EAF9E,iBAGH,CACEI,QAAShB,MAGZiB,MAAK,SAACC,GACL,OAAOA,KAERC,OAAM,SAACC,GACNC,QAAQC,IAAIF,QAILK,EAAU,kBAAM,SAACZ,GAC5B,OAAOC,IACJC,IADI,sIAGH,CACEC,QAAShB,MAGZiB,MAAK,SAACC,GAEL,OADAL,EAAS,CAAEa,KAAM,UAAWC,QAAST,EAAIU,OAClCV,KAERC,OAAM,SAACC,GACNC,QAAQC,IAAIF,S,iCC/ClB,8EAsDeS,IAhDI,SAAC,GAAqC,IAAnCD,EAAkC,EAAlCA,KAAME,EAA4B,EAA5BA,sBACpBjB,EAAWkB,cAOjB,OACE,sBAAKC,UAAU,gBAAf,UACE,sBACEA,UAAS,6BAAwBC,IAAMC,MACvCD,MAAO,CACLE,gBAAiBP,EAAKQ,QAAQC,YAAb,cACNT,EAAKQ,QAAQC,YADP,KAEb,kCACJC,OAAQ,SAEVC,QAhBc,WAClBlB,QAAQC,IAAIM,GACZf,EAAS,CAAEa,KAAM,WAAYC,QAASC,IACtCE,KAKE,UAUE,qBAAKE,UAAU,+CAAf,SACE,qBAAKA,UAAU,4CAAf,SACE,oBAAIA,UAAU,kBAAd,gBAAiCJ,QAAjC,IAAiCA,OAAjC,EAAiCA,EAAMY,aAG3C,qBAAKR,UAAU,eAAf,SACE,cAAC,IAAD,CACEA,UAAU,wCACVS,MAAO,EACPC,SAAU,CAAEC,KAAM,EAAGC,YAAY,GAHnC,gBAKGhB,QALH,IAKGA,OALH,EAKGA,EAAMiB,YAIb,qBAAKb,UAAU,uBAAf,SACE,cAAC,IAAD,CACEU,SAAU,CAAEC,KAAM,EAAGC,YAAY,EAAME,OAAQ,gBAC/Cd,UAAU,sBACVC,MAAO,CAAEc,UAAW,SAHtB,UAKO,OAAJnB,QAAI,IAAJA,OAAA,EAAAA,EAAMoB,eAAN,OAAqBpB,QAArB,IAAqBA,OAArB,EAAqBA,EAAMqB,oBAAqB,oC,oBC9C3DC,EAAOC,QAAU,CAAC,KAAO,sB,iCCDzB,8DAKMC,EAAe,CACnBd,OAAQ,QACRe,MAAO,OACPC,MAAO,OACPC,WAAY,QACZC,UAAW,SACXC,WAAY,WAsHCC,IAlHC,WAAO,IAAD,oCACdC,EAAQC,cAQd,OACE,gCACE,eAAC,IAAD,CAAUC,UAAQ,EAACC,YAAY,SAA/B,WACG,UAAAH,EAAMI,WAAWC,IAAI5B,eAArB,eAA8BC,aAC7B,8BACE,qBACE4B,IAAG,UAAEN,EAAMI,WAAWC,IAAI5B,eAAvB,aAAE,EAA8BC,YACnCJ,MAAOmB,EACPc,IAAI,yBAIR,8BACE,qBAAKD,IAAI,8BAA8BhC,MAAOmB,OAGjD,UAAAO,EAAMI,WAAWC,IAAI5B,eAArB,eAA8B+B,cAC7B,8BACE,qBACEF,IAAG,UAAEN,EAAMI,WAAWC,IAAI5B,eAAvB,aAAE,EAA8B+B,YACnClC,MAAOmB,EACPc,IAAI,0BAIT,UAAAP,EAAMI,WAAWC,IAAI5B,eAArB,eAA8BgC,cAC7B,8BACE,qBACEH,IAAG,UAAEN,EAAMI,WAAWC,IAAI5B,eAAvB,aAAE,EAA8BgC,YACnCnC,MAAOmB,EACPc,IAAI,4BAKZ,cAAC,IAAD,CAASG,OAAK,EAAd,sCACA,cAAC,IAAD,CAAW3B,SAAU,CAAEC,KAAM,EAAGC,YAAY,EAAME,OAAQ,gBAA1D,UACG,UAAAa,EAAMI,WAAWC,WAAjB,eAAsBhB,eAAtB,UACCW,EAAMI,WAAWC,WADlB,aACC,EAAsBf,oBACtB,6BAGJ,8BACE,sBAAKjB,UAAU,OAAf,UACE,qBAAKA,UAAU,qDAAf,sCAGA,qBAAKA,UAAU,mBAAf,SACE,uBAAOA,UAAU,0CAAjB,SACE,kCACE,+BACE,oBAAIqB,MAAM,QAAV,sCACA,oBAAIrB,UAAU,YAAd,SACE,6BAAI,UAAA2B,EAAMI,WAAWC,WAAjB,eAAsBM,WAAY,4BAG1C,+BACE,oBAAIjB,MAAM,QAAV,sCACA,oBAAIrB,UAAU,YAAd,UACG,UAAA2B,EAAMI,WAAWC,WAAjB,mBAAsBO,gBAAtB,eAAgCC,eAAhC,UACDb,EAAMI,WAAWC,WADhB,iBACD,EAAsBO,gBADrB,aACD,EAAgCE,aAC9B,mBAAGlC,QAAS,kBAnEZ,WAClB,IAAMmC,EAAMf,EAAMI,WAAWC,IAAIO,SAASC,YACpCG,EAAMhB,EAAMI,WAAWC,IAAIO,SAASE,YAC1CG,OAAOC,KAAP,yCAA8CH,EAA9C,YAAqDC,GAAO,UAgExBG,IAAe9C,UAAU,eAA3C,UACG,UAAA2B,EAAMI,WAAWC,WAAjB,eAAsBe,UAAW,uBAGpC,gCAAO,UAAApB,EAAMI,WAAWC,WAAjB,eAAsBe,UAAW,4BAI9C,+BACE,oBAAI1B,MAAM,QAAV,sCACA,oBAAIrB,UAAU,YAAd,SACE,cAAC,IAAD,CACEU,SAAU,CAAEC,KAAM,EAAGC,YAAY,EAAME,OAAQ,gBADjD,UAGG,UAAAa,EAAMI,WAAWC,WAAjB,eAAsBgB,aAAc,kCAI3C,+BACE,oBAAI3B,MAAM,QAAV,sCACA,oBAAIrB,UAAU,YAAd,UACG,UAAA2B,EAAMI,WAAWC,WAAjB,eAAsBiB,YACrB,mBACEC,KAAI,UAAEvB,EAAMI,WAAWC,WAAnB,aAAE,EAAsBiB,WAC5BE,OAAO,SACPC,MAAM,eACNpD,UAAU,eAJZ,0BASA,2C,oBCnHtBkB,EAAOC,QAAU,CAAC,KAAO,sB,2JC+DVkC,UApDF,WAAO,IAAD,EACXxE,EAAWkB,cACX4B,EAAQC,cAFG,EAGO0B,mBAAS,IAHhB,mBAGV1D,EAHU,KAGJ2D,EAHI,OAIaD,oBAAS,GAJtB,mBAIVE,EAJU,KAIDC,EAJC,OAKOH,oBAAS,GALhB,mBAKVT,EALU,KAKJa,EALI,KAoBjB,OACE,qCACE,cAAC,IAAD,CACEC,UAAW,EACXC,SAjBO,WACX/E,EAASF,YAAQiB,EAAKiE,SAAS5E,MAAK,SAACC,GAChB,MAAfA,EAAI4E,QACF5E,EAAIU,KAAKiE,OAAS,IACpBJ,GAAW,GAEbF,EAAQ3D,EAAKmE,OAAO7E,EAAIU,QAExBoE,IAAQC,MAAM,qDAUdT,QAASA,EACTU,OACE,qBAAKlE,UAAU,SAAf,wBAA6B,GALjC,SAUE,qBAAKA,UAAU,MAAf,SACGJ,EAAKuE,KAAI,SAACC,GAAD,OACR,cAAC,IAAD,CAAYxE,KAAMwE,EAAGtE,sBAAuB,kBAAM4D,GAAQ,aAIhE,cAAC,IAAD,CACEN,MAAK,UAAEzB,EAAMI,WAAWC,WAAnB,aAAE,EAAsBnB,KAC7BwD,QAASxB,EACTyB,aAAa,OACbC,OAAQ,KACRC,SAAU,kBAAMd,GAAQ,IACxBzD,MAAO,CAAEwE,IAAK,IANhB,SAQE,cAAC,IAAD","file":"static/js/9.01aebe0f.chunk.js","sourcesContent":["import jsSHA from \"jssha\";\n\nconst getPTXauth = () => {\n  var AppID = process.env.REACT_APP_PTX_APP_ID;\n  var AppKey = process.env.REACT_APP_PTX_APP_KEY;\n  var GMTString = new Date().toGMTString();\n  var ShaObj = new jsSHA(\"SHA-1\", \"TEXT\");\n  ShaObj.setHMACKey(AppKey, \"TEXT\");\n  ShaObj.update(\"x-date: \" + GMTString);\n  var HMAC = ShaObj.getHMAC(\"B64\");\n  var Authorization =\n    'hmac username=\"' +\n    AppID +\n    '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' +\n    HMAC +\n    '\"';\n\n  return {\n    Authorization: Authorization,\n    \"X-Date\": GMTString /*,'Accept-Encoding': 'gzip'*/,\n  }; //如果要將js運行在伺服器，可額外加入 'Accept-Encoding': 'gzip'，要求壓縮以減少網路傳輸資料量\n};\n\nexport default getPTXauth;\n","import axios from \"axios\";\nimport getPTXauth from \"../../services/ptxAuth.js\";\n\nexport const loadAll = (skip) => (dispatch) => {\n  return axios\n    .get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?$top=30&$skip=${skip}&$format=JSON`,\n      {\n        headers: getPTXauth(),\n      }\n    )\n    .then((res) => {\n      return res;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\nexport const loadCity = (city, skip) => (dispatch) => {\n  return axios\n    .get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/${city}?$top=30&$skip=${skip}&$format=JSON`,\n      {\n        headers: getPTXauth(),\n      }\n    )\n    .then((res) => {\n      return res;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\n\nexport const loadMap = () => (dispatch) => {\n  return axios\n    .get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?$select=ID%2CName%2CPosition%2CAddress%2CTravelInfo%2COpenTime&$format=JSON`,\n      {\n        headers: getPTXauth(),\n      }\n    )\n    .then((res) => {\n      dispatch({ type: \"SET_MAP\", payload: res.data });\n      return res;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\n","import React from \"react\";\nimport style from \"./style.module.scss\";\nimport Title from \"antd/lib/typography/Title\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport { useDispatch } from \"react-redux\";\n\nconst Attraction = ({ data, handleClickAttraction }) => {\n  const dispatch = useDispatch();\n  const handleClick = () => {\n    console.log(data);\n    dispatch({ type: \"SET_ATTR\", payload: data });\n    handleClickAttraction();\n  };\n\n  return (\n    <div className=\"col-md-3 mb-5\">\n      <div\n        className={`d-flex flex-column ${style.head}`}\n        style={{\n          backgroundImage: data.Picture.PictureUrl1\n            ? `url(${data.Picture.PictureUrl1})`\n            : \"url(resources/images/noImg.png)\",\n          height: \"200px\",\n        }}\n        onClick={handleClick}\n      >\n        <div className=\"card-header card-header-flex border-bottom-0\">\n          <div className=\"d-flex flex-column justify-content-center\">\n            <h5 className=\"mb-0 text-white\">{data?.Class1}</h5>\n          </div>\n        </div>\n        <div className=\"mt-auto mb-2\">\n          <Title\n            className=\"text-white font-weight-bold pl-4 pr-4\"\n            level={4}\n            ellipsis={{ rows: 2, expandable: false }}\n          >\n            {data?.Name}\n          </Title>\n        </div>\n      </div>\n      <div className=\"card card-borderless\">\n        <Paragraph\n          ellipsis={{ rows: 5, expandable: true, symbol: \"更多\" }}\n          className=\"card-body pt-1 pb-1\"\n          style={{ minHeight: \"125px\" }}\n        >\n          {data?.Description || data?.DescriptionDetail || \"沒有資料\"}\n        </Paragraph>\n      </div>\n    </div>\n  );\n};\n\nexport default Attraction;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"head\":\"style_head__1MkLb\"};","import { Carousel, Divider } from \"antd\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport React from \"react\";\nimport { useStore } from \"react-redux\";\n\nconst contentStyle = {\n  height: \"350px\",\n  width: \"100%\",\n  color: \"#fff\",\n  lineHeight: \"160px\",\n  textAlign: \"center\",\n  background: \"#000000\",\n  // background: \"#364d79\",\n};\n\nconst Details = () => {\n  const store = useStore();\n\n  const clickToGMap = () => {\n    const lat = store.getState().ptx.Position.PositionLat;\n    const lng = store.getState().ptx.Position.PositionLon;\n    window.open(`https://maps.google.com/maps?q=${lat},${lng}`, \"_blank\");\n  };\n\n  return (\n    <div>\n      <Carousel autoplay dotPosition=\"bottom\">\n        {store.getState().ptx.Picture?.PictureUrl1 ? (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl1}\n              style={contentStyle}\n              alt=\"圖片一\"\n            />\n          </div>\n        ) : (\n          <div>\n            <img src=\"/resources/images/noImg.png\" style={contentStyle} />\n          </div>\n        )}\n        {store.getState().ptx.Picture?.PictureUrl2 && (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl2}\n              style={contentStyle}\n              alt=\"圖片二\"\n            />\n          </div>\n        )}\n        {store.getState().ptx.Picture?.PictureUrl3 && (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl3}\n              style={contentStyle}\n              alt=\"圖片三\"\n            />\n          </div>\n        )}\n      </Carousel>\n      <Divider plain>詳細資訊</Divider>\n      <Paragraph ellipsis={{ rows: 4, expandable: true, symbol: \"更多\" }}>\n        {store.getState().ptx?.Description ||\n          store.getState().ptx?.DescriptionDetail ||\n          \"沒有資料\"}\n      </Paragraph>\n\n      <div>\n        <div className=\"mb-3\">\n          <div className=\"bg-light text-gray-6 text-uppercase px-3 py-1 mb-2\">\n            景點資訊\n          </div>\n          <div className=\"table-responsive\">\n            <table className=\"table table-borderless text-gray-6 mb-0\">\n              <tbody>\n                <tr>\n                  <td width=\"100px\">開放時間</td>\n                  <td className=\"text-left\">\n                    <p>{store.getState().ptx?.OpenTime || \"無資料\"}</p>\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">景點地址</td>\n                  <td className=\"text-left\">\n                    {store.getState().ptx?.Position?.PositionLat &&\n                    store.getState().ptx?.Position?.PositionLon ? (\n                      <a onClick={() => clickToGMap()} className=\"text-primary\">\n                        {store.getState().ptx?.Address || \"無資料\"}\n                      </a>\n                    ) : (\n                      <span>{store.getState().ptx?.Address || \"無資料\"}</span>\n                    )}\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">交通方式</td>\n                  <td className=\"text-left\">\n                    <Paragraph\n                      ellipsis={{ rows: 4, expandable: true, symbol: \"更多\" }}\n                    >\n                      {store.getState().ptx?.TravelInfo || \"沒有資料\"}\n                    </Paragraph>\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">活動網址</td>\n                  <td className=\"text-left\">\n                    {store.getState().ptx?.WebsiteUrl ? (\n                      <a\n                        href={store.getState().ptx?.WebsiteUrl}\n                        target=\"_blank\"\n                        title=\"點我\"\n                        className=\"text-primary\"\n                      >\n                        點我\n                      </a>\n                    ) : (\n                      \"無資料\"\n                    )}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Details;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"head\":\"style_head__3IS3c\"};","import React, { useState } from \"react\";\nimport { Carousel, Divider, message, Modal } from \"antd\";\nimport \"antd/dist/antd.css\";\nimport { useDispatch, useStore } from \"react-redux\";\nimport { loadAll } from \"../../redux/ptx/actions\";\nimport Attraction from \"../../components/attraction\";\nimport style from \"./style.module.scss\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport Title from \"antd/lib/typography/Title\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport Details from \"../../components/details\";\n\nconst Home = () => {\n  const dispatch = useDispatch();\n  const store = useStore();\n  const [data, setData] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const [open, setOpen] = useState(false);\n\n  const load = () => {\n    dispatch(loadAll(data.length)).then((res) => {\n      if (res.status === 200) {\n        if (res.data.length < 30) {\n          setHasMore(false);\n        }\n        setData(data.concat(res.data));\n      } else {\n        message.error(\"無法讀取ptx資料。\");\n      }\n    });\n  };\n\n  return (\n    <>\n      <InfiniteScroll\n        pageStart={0}\n        loadMore={load}\n        hasMore={hasMore}\n        loader={\n          <div className=\"loader\" key={0}>\n            Loading ...\n          </div>\n        }\n      >\n        <div className=\"row\">\n          {data.map((e) => (\n            <Attraction data={e} handleClickAttraction={() => setOpen(true)} />\n          ))}\n        </div>\n      </InfiniteScroll>\n      <Modal\n        title={store.getState().ptx?.Name}\n        visible={open}\n        maskClosable=\"true\"\n        footer={null}\n        onCancel={() => setOpen(false)}\n        style={{ top: 10 }}\n      >\n        <Details />\n      </Modal>\n    </>\n  );\n};\n\nexport default Home;\n"],"sourceRoot":""}