{"version":3,"sources":["components/attraction/index.js","components/attraction/style.module.scss","components/details/index.js","services/ptxAuth.js","redux/ptx/actions.js","pages/allspot/style.module.scss","pages/allspot/index.js"],"names":["Attraction","data","handleClickAttraction","dispatch","useDispatch","className","style","head","backgroundImage","Picture","PictureUrl1","height","onClick","console","log","type","payload","Class1","level","ellipsis","rows","expandable","Name","symbol","minHeight","Description","DescriptionDetail","module","exports","contentStyle","width","color","lineHeight","textAlign","background","Details","store","useStore","autoplay","dotPosition","getState","ptx","src","alt","PictureUrl2","PictureUrl3","plain","OpenTime","Position","PositionLat","PositionLon","lat","lng","window","open","clickToGMap","Address","TravelInfo","WebsiteUrl","href","target","title","getPTXauth","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","process","update","Authorization","getHMAC","loadAll","skip","axios","get","headers","then","res","catch","err","loadCity","city","Home","useState","setData","hasMore","setHasMore","setOpen","pageStart","loadMore","length","status","concat","message","error","loader","map","e","visible","maskClosable","footer","onCancel","top"],"mappings":"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","file":"static/js/6.dd32c291.chunk.js","sourcesContent":["import React from \"react\";\nimport style from \"./style.module.scss\";\nimport Title from \"antd/lib/typography/Title\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport { useDispatch } from \"react-redux\";\n\nconst Attraction = ({ data, handleClickAttraction }) => {\n  const dispatch = useDispatch();\n  const handleClick = () => {\n    console.log(data);\n    dispatch({ type: \"SET_ATTR\", payload: data });\n    handleClickAttraction();\n  };\n\n  return (\n    <div className=\"col-md-3 mb-5\">\n      <div\n        className={`d-flex flex-column ${style.head}`}\n        style={{\n          backgroundImage: data.Picture.PictureUrl1\n            ? `url(${data.Picture.PictureUrl1})`\n            : \"url(resources/images/noImg.png)\",\n          height: \"200px\",\n        }}\n        onClick={handleClick}\n      >\n        <div className=\"card-header card-header-flex border-bottom-0\">\n          <div className=\"d-flex flex-column justify-content-center\">\n            <h5 className=\"mb-0 text-white\">{data?.Class1}</h5>\n          </div>\n        </div>\n        <div className=\"mt-auto mb-2\">\n          <Title\n            className=\"text-white font-weight-bold pl-4 pr-4\"\n            level={4}\n            ellipsis={{ rows: 2, expandable: false }}\n          >\n            {data?.Name}\n          </Title>\n        </div>\n      </div>\n      <div className=\"card card-borderless\">\n        <Paragraph\n          ellipsis={{ rows: 5, expandable: true, symbol: \"更多\" }}\n          className=\"card-body pt-1 pb-1\"\n          style={{ minHeight: \"125px\" }}\n        >\n          {data?.Description || data?.DescriptionDetail || \"沒有資料\"}\n        </Paragraph>\n      </div>\n    </div>\n  );\n};\n\nexport default Attraction;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"head\":\"style_head__1MkLb\"};","import { Carousel, Divider } from \"antd\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport React from \"react\";\nimport { useStore } from \"react-redux\";\n\nconst contentStyle = {\n  height: \"350px\",\n  width: \"100%\",\n  color: \"#fff\",\n  lineHeight: \"160px\",\n  textAlign: \"center\",\n  background: \"#000000\",\n  // background: \"#364d79\",\n};\n\nconst Details = () => {\n  const store = useStore();\n\n  const clickToGMap = () => {\n    const lat = store.getState().ptx.Position.PositionLat;\n    const lng = store.getState().ptx.Position.PositionLon;\n    window.open(`https://maps.google.com/maps?q=${lat},${lng}`, \"_blank\");\n  };\n\n  return (\n    <div>\n      <Carousel autoplay dotPosition=\"bottom\">\n        {store.getState().ptx.Picture?.PictureUrl1 ? (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl1}\n              style={contentStyle}\n              alt=\"圖片一\"\n            />\n          </div>\n        ) : (\n          <div>\n            <img src=\"/resources/images/noImg.png\" style={contentStyle} />\n          </div>\n        )}\n        {store.getState().ptx.Picture?.PictureUrl2 && (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl2}\n              style={contentStyle}\n              alt=\"圖片二\"\n            />\n          </div>\n        )}\n        {store.getState().ptx.Picture?.PictureUrl3 && (\n          <div>\n            <img\n              src={store.getState().ptx.Picture?.PictureUrl3}\n              style={contentStyle}\n              alt=\"圖片三\"\n            />\n          </div>\n        )}\n      </Carousel>\n      <Divider plain>詳細資訊</Divider>\n      <Paragraph ellipsis={{ rows: 4, expandable: true, symbol: \"更多\" }}>\n        {store.getState().ptx?.Description ||\n          store.getState().ptx?.DescriptionDetail ||\n          \"沒有資料\"}\n      </Paragraph>\n\n      <div>\n        <div className=\"mb-3\">\n          <div className=\"bg-light text-gray-6 text-uppercase px-3 py-1 mb-2\">\n            景點資訊\n          </div>\n          <div className=\"table-responsive\">\n            <table className=\"table table-borderless text-gray-6 mb-0\">\n              <tbody>\n                <tr>\n                  <td width=\"100px\">開放時間</td>\n                  <td className=\"text-left\">\n                    <p>{store.getState().ptx?.OpenTime || \"無資料\"}</p>\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">景點地址</td>\n                  <td className=\"text-left\">\n                    {store.getState().ptx?.Position?.PositionLat &&\n                    store.getState().ptx?.Position?.PositionLon ? (\n                      <a onClick={() => clickToGMap()} className=\"text-primary\">\n                        {store.getState().ptx?.Address || \"無資料\"}\n                      </a>\n                    ) : (\n                      <span>{store.getState().ptx?.Address || \"無資料\"}</span>\n                    )}\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">交通方式</td>\n                  <td className=\"text-left\">\n                    <Paragraph\n                      ellipsis={{ rows: 4, expandable: true, symbol: \"更多\" }}\n                    >\n                      {store.getState().ptx?.TravelInfo || \"沒有資料\"}\n                    </Paragraph>\n                  </td>\n                </tr>\n                <tr>\n                  <td width=\"100px\">活動網址</td>\n                  <td className=\"text-left\">\n                    {store.getState().ptx?.WebsiteUrl ? (\n                      <a\n                        href={store.getState().ptx?.WebsiteUrl}\n                        target=\"_blank\"\n                        title=\"點我\"\n                        className=\"text-primary\"\n                      >\n                        點我\n                      </a>\n                    ) : (\n                      \"無資料\"\n                    )}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Details;\n","import jsSHA from \"jssha\";\n\nconst getPTXauth = () => {\n  var AppID = process.env.REACT_APP_PTX_APP_ID;\n  var AppKey = process.env.REACT_APP_PTX_APP_KEY;\n  var GMTString = new Date().toGMTString();\n  var ShaObj = new jsSHA(\"SHA-1\", \"TEXT\");\n  ShaObj.setHMACKey(AppKey, \"TEXT\");\n  ShaObj.update(\"x-date: \" + GMTString);\n  var HMAC = ShaObj.getHMAC(\"B64\");\n  var Authorization =\n    'hmac username=\"' +\n    AppID +\n    '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' +\n    HMAC +\n    '\"';\n\n  return {\n    Authorization: Authorization,\n    \"X-Date\": GMTString /*,'Accept-Encoding': 'gzip'*/,\n  }; //如果要將js運行在伺服器，可額外加入 'Accept-Encoding': 'gzip'，要求壓縮以減少網路傳輸資料量\n};\n\nexport default getPTXauth;\n","import axios from \"axios\";\nimport getPTXauth from \"../../services/ptxAuth.js\";\n\nexport const loadAll = (skip) => (dispatch) => {\n  return axios\n    .get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?$top=30&$skip=${skip}&$format=JSON`,\n      {\n        headers: getPTXauth(),\n      }\n    )\n    .then((res) => {\n      return res;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\nexport const loadCity = (city, skip) => (dispatch) => {\n  return axios\n    .get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/${city}?$top=30&$skip=${skip}&$format=JSON`,\n      {\n        headers: getPTXauth(),\n      }\n    )\n    .then((res) => {\n      return res;\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"head\":\"style_head__3IS3c\"};","import React, { useState } from \"react\";\nimport { Carousel, Divider, message, Modal } from \"antd\";\nimport \"antd/dist/antd.css\";\nimport { useDispatch, useStore } from \"react-redux\";\nimport { loadAll } from \"../../redux/ptx/actions\";\nimport Attraction from \"../../components/attraction\";\nimport style from \"./style.module.scss\";\nimport Paragraph from \"antd/lib/typography/Paragraph\";\nimport Title from \"antd/lib/typography/Title\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport Details from \"../../components/details\";\n\nconst Home = () => {\n  const dispatch = useDispatch();\n  const store = useStore();\n  const [data, setData] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const [open, setOpen] = useState(false);\n\n  const load = () => {\n    dispatch(loadAll(data.length)).then((res) => {\n      if (res.status === 200) {\n        if (res.data.length < 30) {\n          setHasMore(false);\n        }\n        setData(data.concat(res.data));\n      } else {\n        message.error(\"無法讀取ptx資料。\");\n      }\n    });\n  };\n\n  return (\n    <>\n      <InfiniteScroll\n        pageStart={0}\n        loadMore={load}\n        hasMore={hasMore}\n        loader={\n          <div className=\"loader\" key={0}>\n            Loading ...\n          </div>\n        }\n      >\n        <div className=\"row\">\n          {data.map((e) => (\n            <Attraction data={e} handleClickAttraction={() => setOpen(true)} />\n          ))}\n        </div>\n      </InfiniteScroll>\n      <Modal\n        title={store.getState().ptx?.Name}\n        visible={open}\n        maskClosable=\"true\"\n        footer={null}\n        onCancel={() => setOpen(false)}\n        style={{ top: 10 }}\n      >\n        <Details />\n      </Modal>\n    </>\n  );\n};\n\nexport default Home;\n"],"sourceRoot":""}